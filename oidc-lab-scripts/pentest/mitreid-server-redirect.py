#!/usr/bin/env python3

from lib.attacks import *
from lib.client import MITMClient

if __name__ == "__main__":
    client = MITMClient()
    # cleanup previous mitm proxy hooks
    client.send(ClearCommand())

    # replace redirect_uri with a XSS check
    # mitreid-server escapes special characters before displaying it
    cmd = ReplaceCommand()
    cmd.uri = "mitreid-server/oidc-server/authorize"
    cmd.replaceKeyVal("redirect_uri", '<script>alert("Hello!");</script>')

    client.send(cmd)
