import json
import socket


class MITMClient:
    def __init__(self, ip="localhost", port=8042):
        self.ip = ip
        self.port = port

    def send(self, attackCommand):
        data = json.dumps(attackCommand.__dict__)
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
            sock.connect((self.ip, self.port))
            sock.sendall(bytes(data + "\n", 'ascii'))
            response = str(sock.recv(1024), 'ascii')
            print("Received: {}".format(response))

